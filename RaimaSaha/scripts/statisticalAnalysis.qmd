# Chi-Squared Testing

**MAKE SOME PLOTS**

Conducting a chi-square test to test whether there is a correlation between two variables or not.

Null hypothesis: There is no significant relationship or correlation between variable \_\_\_\_\_ and human_interaction.

Alternative hypothesis: There is a significant relationship or correlation between variable \_\_\_\_\_\_ and human_interaction.

Setting significance level at 0.05 – if p-value is less than 0.05, then there is a correlation between \_\_\_\_\_\_\_\_ and human_interaction; otherwise, there isn't.

```{r}
# Install necessary packages if not already installed
if (!require("dplyr")) install.packages("dplyr") 
if (!require("janitor")) install.packages("janitor")
if (!require("ggplot2")) install.packages("ggplot2")
if (!require("tidyr")) install.packages("tidyr")
if (!require("stringr")) install.packages("stringr")
if (!require("corrplot")) install.packages("corrplot")

# Load necessary libraries
library(tidyr) 
library(tidyverse) 
library(dplyr) 
library(ggplot2) 
library(stringr)
library(corrplot)

# Loading in data
getwd()

filename <- "RaimaSaha/squirrel_data_clean.csv"

clean_data <- read.csv(filename)  

head(clean_data)
clean_data
```

Conducting chi-squared analysis between hectare and human interaction

```{r}
# creating a contingency table
contingency_table <- table(clean_data$hectare, clean_data$human_interaction)

# performing chi-squared test
chisq_results <- chisq.test(contingency_table)
```

Extracting results

```{r}
# extracting p-value
p_val <- chisq_results$p.value
p_val

# extracting residuals
residuals <- chisq_results$residuals
residuals
```

**FIX THIS!!!** Too few data points per each value occurrence is causing chi-squared test to be faulty and not produce a p-value. Creating a new version of the hectare column where it will only grouped by numbers. For example, entries that correspond with 42A-42C will be grouped under 42.

```{r}
# hectare_group_data <- gsub(c("A", "B", "C", "D", "E", "F", "G", "H", "I"),"", as.character(clean_data$hectare))
# hectare_group_data <- gsub("B","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("C","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("D","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("E","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("F","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("G","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("H","", as.character(clean_data$hectare))
# hectare_group_data <- gsub("I","", as.character(clean_data$hectare))
clean_data

clean_data$hectare_num <- clean_data$hectare
clean_data <- clean_data |>
  select(latitude:hectare, hectare_num, everything())
clean_data

hectare_num <- clean_data |>
   list(x = _) |>
  with(replace(x, TRUE, lapply(x, trimws, whitespace = "\\D"))) |>
   type.convert(as.is = TRUE)

# clean_data$hectare_num <- type.convert(with(replace(x, TRUE, lapply(clean_data, trimws, whitespace = "\\D")), as.is = FALSE))

hectare_group_data <- gsub("//D","", as.character(clean_data$hectare))
# hectare_group_data <- gsub(clean_data, "//D", "")
# hectare_group_data$hectare <- as.factor(hectare_group_data$hectare)
# 
hectare_group_data
```

Conducting chi-squared analysis between hectare (number) and human interaction.

```{r}
contingency_table <- table(hectare_group_data$human_interaction, hectare_group_data$hectare)

# performing chi-squared test
chisq_results <- chisq.test(contingency_table)
```

Extracting results

```{r}
# extracting p-value
p_val <- chisq_results$p.value
p_val

# extracting residuals
residuals <- chisq_results$residuals
residuals
```

Conducting chi-squared analysis between shift and human interaction.

```{r}
# creating a contingency table
contingency_table <- table(clean_data$shift, clean_data$human_interaction)
contingency_table

# performing chi-squared test
chisq_results <- chisq.test(contingency_table)
chisq_results
```

Extracting results

```{r}
# extracting p-value
p_val <- chisq_results$p.value
p_val

# extracting residuals
residuals <- chisq_results$residuals
residuals

shift_observed <- chisq_results$observed
shift_observed

shift_expected <- chisq_results$expected
shift_expected
```

0.005426958 \< 0.05 ∴ reject the null hypothesis since there is statistically significant association between shift and human interaction.

Correlation plot of shift and human interaction

```{r}
corrplot(chisq_results$residuals, is.cor = FALSE, method = "color")
```

Conducting chi-squared analysis between location and human interaction

```{r}
# creating a contingency table
contingency_table <- table(clean_data$location, clean_data$human_interaction)

# performing chi-squared test
chisq_results <- chisq.test(contingency_table)
```

Extracting results

```{r}
# extracting p-value
p_val <- chisq_results$p.value
p_val

# extracting residuals
residuals <- chisq_results$residuals
residuals
```

0.008341746 \< 0.05 ∴ reject the null hypothesis since there is a statistically significant association between ground location and human interaction.

Correlation plot of location and human interaction

```{r}
corrplot(chisq_results$residuals, is.cor = FALSE, method = "color")
```

Conducting chi-squared analysis between primary fur color and human interaction

```{r}
# creating a contingency table
contingency_table <- table(clean_data$primary_fur_color, clean_data$human_interaction)

# performing chi-squared test
chisq_results <- chisq.test(contingency_table)
```

Extracting results

```{r}
p_val <- chisq_results$p.value
p_val

# extracting residuals
residuals <- chisq_results$residuals
residuals
```

6.31357e-06 \< 0.05 ∴ reject the null hypothesis since there is a statistically significant association between primary fur color and human interaction.

Correlation plot of primary fur color and human interaction

```{r}
corrplot(chisq_results$residuals, is.cor = FALSE, method = "color")
```
